
# VSCode Intellisense For Your Mbed Projects

`mbed-vscode-tools` is made for software engineers who want to develop their mbed projects in vscode instead of mbed studio.
The tool offers a commandline interface to generate and update your c_cpp_properties.json for correct vscode intellisense.

## Notes

* This tool works in conjunction with the official cli tool (`mbed-tools`) provided by the mbed team.
* We assume that the users know how to use mbed-tools and its workflow. Otherwise see [the official docs](https://os.mbed.com/docs/mbed-os/v6.15/build-tools/use.html). 

## Dependencies

Python interpreter:

* python >= 3.6.0 (f strings are used in our code)

Python packages:

* click >= 8.0.0

Other softwares:

* mbed-tools >= 7.0.0
* arm-none-eabi-gcc >= 9.0.0 or armcc >= 6.0.0
* cmake >= 3.19.0
* ninja >= 1.0.0

## Installation

```bash
$ pip install mbed-vscode-tools
```

Run `$ pip uninstall mbed-vscode-tools` to uninstall mbed-vscode-tools.

## Tutorial

### Create c_cpp_properties.json

Create your c_cpp_properties.json **that has \"Mbed\" configuration entry** like below:

```json
{
    "env": {},
    "configurations": [
        {
            // "Mbed" entry will be automatically managed and updated by this tool.
            "name": "Mbed",
            "compilerPath": "/usr/bin/arm-none-eabi-gcc",  // Path to an arm-compiler executable to use
            "includePath": [],       // Leave empty
            "defines": [],           // Leave empty
            "cStandard": "c17",      // Set your favorite
            "cppStandard": "c++17",  // Set your favorite
            "intelliSenseMode": "gcc-arm"  // Depends on your compiler
        }
    ],
    "version": 4
}
```

### Configure build settings & Update your c_cpp_properties.json

Make sure that you've run `$ mbed-tools configure` before reading further.

Then run `$ mbed-vscode-tools configure` to tell the build settings for this tool as follows:

```bash
$ mbed-vscode-tools MBED_TOOLCHAIN MBED_TARGET VSCODE_CONF_FILE
```

* `MBED_TOOLCHAIN`  
  Choose `GCC_ARM` or `ARM` depending on your compiler.
* `MBED_TARGET`  
  Specify an mbed-enabled board identifier.  
  You can find it by connecting your board via usb and run `$ mbed-tools detect`.
* `VSCODE_CONF_FILE`  
  Path to your c_cpp_properties.json.

**`MBED_TOOLCHAIN` and `MBED_TARGET` must be the same with `$ mbed-tools configure` arguments.**

Example: If you use gnu arm compiler and DISCO-L072CZ-LRWAN1 development board, and if your c_cpp_properties.json located at `./.vscode/c_cpp_properties.json`, run the following command:

```bash
$ mbed-vscode-tools GCC_ARM DISCO_L072CZ_LRWAN1 .vscode/c_cpp_properties.json
```

Make sure that `includePath` and `defines` fields of your c_cpp_properties.json is automatically completed
and your vscode intellisense works fine.

### (Optional) Update your c_cpp_properties.json

Once you configure your build settings by `$ mbed-vscode-tools configure`,
you can quickly update c_cpp_properties.json by running below:

```bash
$ mbed-vscode-tools update
```

This command was implemented just for quick workflow (you can use only `$ mbed-vscode-tools configure` to update your c_cpp_properties.json).

## Workflow

## Documentation

The mbed-vscode-tools offers following three commands: `configure`, `generate`, and `update`.

See the documantion below for details of each command.

### `configure`

Configure the build settings.

```
$ mbed-vscode-tools configure MBED_TOOLCHAIN MBED_TARGET VSCODE_CONF_FILE [--mbed-profile [debug|develop|release]] [--mbed-program-dir directory] [--help]
```

**Positional Arguments**

* `MBED_TOOL_CHAIN`  
  Select \"GCC_ARM\" or "ARM". Set \"GCC_ARM\" if you use the gnu arm embedded toolchain (arm-none-eabi-gcc). Set \"ARM\" if you use the arm compiler (armcc). Note that armcc is a paid compiler.
* `MBED_TARGET`  
  Set a target mbed-enabled board identifier.
  You can find it by `$ mbed-tools detect` command.
* `VSCODE_CONF_FILE`  
  Path to your c_cpp_properties.json.
  The file must have \"Mbed\" configuration entry,
  which will be inherited by \"MbedAuto\" entry
  automatically generated by this tool.
  You can generate a template of your c_cpp_properties.json
  by `generate` command for quick start.

**Options**

* `--mbed-profile`  
  Select a build profile from \"debug\", \"develop\", and \"release\". See [here](https://os.mbed.com/docs/mbed-os/v6.15/program-setup/build-profiles-and-rules.html) for the specification of each profile. [default: develop]
* `--mbed-program-dir`  
  Path to an mbed program directory. [default: current working directory]

### `update`

Update your c_cpp_properties.json.

```
$ mbed-vscode-tools update [--tool-conf-file]
```

**Positional Arguments**

No positional arguments.

**Options**

* `--tool-conf-file`  
  Path to the tool config file (.mbed-vscode-tools.json) generated by `configure` command. [default: ./.mbed-vscode-tools.json]
